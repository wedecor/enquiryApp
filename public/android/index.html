<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>We Decor Enquiries â€“ Internal RC3</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;margin:24px;max-width:720px;line-height:1.6}
    h1{color:#2563eb;margin-bottom:8px}
    .version{background:#f1f5f9;padding:4px 12px;border-radius:16px;font-size:0.9rem;display:inline-block;margin-bottom:16px}
    .btn{display:inline-block;padding:12px 16px;border-radius:10px;border:1px solid #222;text-decoration:none;background:#2563eb;color:white;font-weight:600;margin:8px 8px 8px 0}
    .btn:hover{background:#1d4ed8}
    .btn.secondary{background:white;color:#222;border:1px solid #ccc}
    .btn.secondary:hover{background:#f8fafc}
    .card{border:1px solid #e2e8f0;border-radius:16px;padding:20px;margin:16px 0;background:#fafafa}
    .qr{display:flex;gap:20px;align-items:center;flex-wrap:wrap}
    .qr-code{min-width:160px}
    code{background:#f6f8fa;padding:2px 6px;border-radius:6px;font-family:Monaco,Consolas,monospace;font-size:0.85rem;word-break:break-all}
    .security{background:#fef3c7;border:1px solid #f59e0b;color:#92400e}
    .install{background:#ecfdf5;border:1px solid #10b981;color:#047857}
    .improvements{background:#f0f9ff;border:1px solid #0ea5e9;color:#0c4a6e}
    ul{margin:12px 0}
    li{margin:6px 0}
    .footer{margin-top:32px;padding-top:16px;border-top:1px solid #e2e8f0;font-size:0.9rem;color:#64748b}
    .status{display:inline-block;padding:2px 8px;border-radius:8px;font-size:0.8rem;font-weight:600;margin-left:8px}
    .status.rc3{background:#dcfce7;color:#166534}
    .status.pilot{background:#fef3c7;color:#92400e}
  </style>
</head>
<body>
        <h1>We Decor Enquiries <span class="status rc3">Production</span></h1>
        <div id="version" class="version">Loading versionâ€¦</div>
  
  <p>Download the latest version with enhanced features, improved notifications, and web compatibility improvements.</p>

  <div class="card qr">
    <div class="qr-code">
      <div id="qrcode"></div>
    </div>
    <div>
      <a id="apkLink" class="btn" href="#" download>ğŸ“± Download APK</a>
      <a id="shaLink" class="btn secondary" href="#" target="_blank">ğŸ”’ Verify Checksum</a>
      <p><strong>SHA256:</strong><br><code id="sha256">loadingâ€¦</code></p>
    </div>
  </div>

  <div class="card security">
    <h3>ğŸ” Security Verification</h3>
    <p><strong>Always verify the APK integrity before installation:</strong></p>
    <p>Run: <code id="shaCmd">shasum -a 256 &lt;apk-name&gt;.apk</code> and compare with the SHA256 above.</p>
  </div>

        <div class="card" style="background:#dcfce7;border:1px solid #16a34a;color:#166534">
            <h3>ğŸ‰ Latest Release (<span id="headingVersion">v2.0.5+29</span>)</h3>
            <div id="releaseNotes" style="margin-top: 12px;">
                <p><strong>Loading release notes...</strong></p>
            </div>
            <div id="featuresList" style="margin-top: 12px; display: none;">
                <h4 style="margin-top: 16px; margin-bottom: 8px;">âœ¨ New Features:</h4>
                <ul id="features"></ul>
            </div>
            <div id="bugFixesList" style="margin-top: 12px; display: none;">
                <h4 style="margin-top: 16px; margin-bottom: 8px;">ğŸ› Bug Fixes:</h4>
                <ul id="bugFixes"></ul>
            </div>
        </div>

  <div class="card improvements">
    <h3>ğŸš€ Key Features</h3>
    <ul>
      <li><strong>ğŸ“ Contact Shortcuts:</strong> Call/WhatsApp buttons in enquiry details</li>
      <li><strong>ğŸ¨ Instant Theme Switching:</strong> Settings â†’ Preferences â†’ Appearance</li>
      <li><strong>ğŸŒ™ Enhanced Dark Mode:</strong> Better color contrast and theme consistency</li>
      <li><strong>ğŸ” Advanced Filters:</strong> Faceted search with saved views</li>
      <li><strong>ğŸ”„ Manual Update Check:</strong> Settings â†’ Account â†’ Check for Updates</li>
      <li><strong>ğŸ’¬ In-App Feedback:</strong> Settings â†’ Privacy â†’ Send Feedback</li>
      <li><strong>ğŸ“± Review Requests:</strong> Request Google reviews and Instagram follows for completed events</li>
      <li><strong>ğŸ“Š Performance Monitoring:</strong> Real-time health dashboards</li>
    </ul>
  </div>

  <div class="card install">
    <h3>ğŸ“² Installation Instructions</h3>
    <ol>
      <li>Download the APK file to your Android device</li>
      <li>Go to <strong>Settings â†’ Security â†’ Install unknown apps</strong></li>
      <li>Enable installation for your browser or file manager</li>
      <li>Open the downloaded APK file and tap "Install"</li>
      <li>Launch "We Decor Enquiries" from your app drawer</li>
    </ol>
    <p><strong>Note:</strong> Always download from the official source to ensure security.</p>
  </div>


  <div class="card">
    <h3>ğŸŒ Web Version Available</h3>
    <p>Test the enhanced web version with improved monitoring:</p>
    <a class="btn" href="/web/" target="_blank">ğŸŒ Open Web App</a>
    <p><small>Includes same feedback system and performance improvements!</small></p>
  </div>

  <div class="footer">
    <p><strong>ğŸ“± Production Release</strong> - Latest stable version</p>
    <p><strong>Feedback:</strong> In-app form or contact support | <strong>Health:</strong> Firebase Console</p>
    <p><strong>Version Info:</strong> Automatically loaded from version.json</p>
  </div>

  <script src="https://unpkg.com/qrcodejs@1.0.0/qrcode.min.js"></script>
  <script>
    async function loadVersion() {
      try {
        const res = await fetch('./version.json', { cache: 'no-store' });
        const v = await res.json();
        const versionStr = `v${v.version}+${v.buildNumber} â€¢ Release: ${v.releaseDate}`;
        document.getElementById('version').textContent = versionStr;
        document.getElementById('headingVersion').textContent = `v${v.version}+${v.buildNumber}`;
        document.getElementById('apkLink').href = v.downloadUrl;
        document.getElementById('shaLink').href = v.downloadUrl.replace(/\.apk$/, '.apk.sha256.txt');
        document.getElementById('sha256').textContent = v.sha256 || 'unknown';
        const apkFileName = v.downloadUrl.split('/').pop();
        document.getElementById('shaCmd').textContent = `shasum -a 256 ${apkFileName}`;

        // Display release notes
        if (v.releaseNotes) {
          document.getElementById('releaseNotes').innerHTML = `<p>${v.releaseNotes.replace(/\n/g, '<br>')}</p>`;
        }

        // Display features
        if (v.features && v.features.length > 0) {
          document.getElementById('featuresList').style.display = 'block';
          const featuresList = document.getElementById('features');
          v.features.forEach(feature => {
            const li = document.createElement('li');
            li.textContent = feature;
            featuresList.appendChild(li);
          });
        }

        // Display bug fixes
        if (v.bugFixes && v.bugFixes.length > 0) {
          document.getElementById('bugFixesList').style.display = 'block';
          const bugFixesList = document.getElementById('bugFixes');
          v.bugFixes.forEach(fix => {
            const li = document.createElement('li');
            li.textContent = fix;
            bugFixesList.appendChild(li);
          });
        }

        // QR code for APK URL (use full URL if relative)
        const qrUrl = v.downloadUrl.startsWith('http') ? v.downloadUrl : window.location.origin + window.location.pathname.replace(/\/$/, '') + '/' + v.downloadUrl;
        new QRCode(document.getElementById('qrcode'), {
          text: qrUrl,
          width: 160,
          height: 160,
          colorDark: '#2563eb',
          colorLight: '#ffffff'
        });
      } catch (e) {
        document.getElementById('version').textContent = 'Failed to load version info';
        console.error(e);
      }
    }
    loadVersion();
  </script>
</body>
</html>
